Index: squid/src/cf.data.pre
diff -c squid/src/cf.data.pre:1.245.2.66 squid/src/cf.data.pre:1.245.2.67
*** squid/src/cf.data.pre:1.245.2.66	Fri Apr 30 14:40:39 2004
--- squid/src/cf.data.pre	Sat Jul 17 13:53:25 2004
***************
*** 1343,1348 ****
--- 1343,1355 ----
  	also use the max_user_ip ACL in an http_access rule.
  	auth_param basic credentialsttl 2 hours
  
+ 	"casesensitive" on|off
+ 	Specifies if usernames are case sensitive. Most user databases are
+ 	case insensitive allowing the same username to be spelled using both
+ 	lower and upper case letters, but some are case sensitive. This
+ 	makes a big difference for user_max_ip ACL processing and similar.
+ 	auth_param basic casesensitive off
+ 
  	=== Parameters for the digest scheme follow ===
  
  	"program" cmdline
Index: squid/src/auth/basic/auth_basic.c
diff -c squid/src/auth/basic/auth_basic.c:1.14.2.6 squid/src/auth/basic/auth_basic.c:1.14.2.7
*** squid/src/auth/basic/auth_basic.c:1.14.2.6	Sat Apr 17 19:29:52 2004
--- squid/src/auth/basic/auth_basic.c	Sat Jul 17 13:53:25 2004
***************
*** 341,346 ****
--- 341,348 ----
  	parse_eol(&basicConfig->basicAuthRealm);
      } else if (strcasecmp(param_str, "credentialsttl") == 0) {
  	parse_time_t(&basicConfig->credentialsTTL);
+     } else if (strcasecmp(param_str, "casesensitive") == 0) {
+ 	parse_onoff(&basicConfig->casesensitive);
      } else {
  	debug(28, 0) ("unrecognised basic auth scheme parameter '%s'\n", param_str);
      }
***************
*** 486,491 ****
--- 488,495 ----
  	local_basic.passwd = xstrndup(cleartext, USER_IDENT_SZ);
      }
  
+     if (!basicConfig->casesensitive)
+ 	Tolower(local_basic.username);
      /* now lookup and see if we have a matching auth_user structure in memory. */
  
      if ((auth_user = authBasicAuthUserFindUsername(local_basic.username)) == NULL) {
Index: squid/src/auth/basic/auth_basic.h
diff -c squid/src/auth/basic/auth_basic.h:1.3.2.1 squid/src/auth/basic/auth_basic.h:1.3.2.2
*** squid/src/auth/basic/auth_basic.h:1.3.2.1	Wed Feb 18 10:50:51 2004
--- squid/src/auth/basic/auth_basic.h	Sat Jul 17 13:53:25 2004
***************
*** 41,46 ****
--- 41,47 ----
      char *basicAuthRealm;
      wordlist *authenticate;
      time_t credentialsTTL;
+     int casesensitive;
  };
  
  typedef struct _auth_basic_config auth_basic_config;
