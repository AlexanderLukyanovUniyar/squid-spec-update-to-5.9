Index: squid/src/client_side.c
diff -c squid/src/client_side.c:1.561.2.55 squid/src/client_side.c:1.561.2.56
*** squid/src/client_side.c:1.561.2.55	Mon May 31 16:57:09 2004
--- squid/src/client_side.c	Sat Jul 17 10:01:50 2004
***************
*** 2594,2599 ****
--- 2594,2605 ----
      xmemcpy(inbuf, conn->in.buf, req_sz);
      *(inbuf + req_sz) = '\0';
  
+     /* Enforce max_request_size */
+     if (req_sz >= Config.maxRequestHeaderSize) {
+ 	debug(33, 5) ("parseHttpRequest: Too large request\n");
+ 	xfree(inbuf);
+ 	return parseHttpRequestAbort(conn, "error:request-too-large");
+     }
      /* Barf on NULL characters in the headers */
      if (strlen(inbuf) != req_sz) {
  	debug(33, 1) ("parseHttpRequest: Requestheader contains NULL characters\n");
