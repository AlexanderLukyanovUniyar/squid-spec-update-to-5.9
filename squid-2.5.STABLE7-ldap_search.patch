Index: squid/helpers/basic_auth/LDAP/squid_ldap_auth.c
diff -c squid/helpers/basic_auth/LDAP/squid_ldap_auth.c:1.21.2.15 squid/helpers/basic_auth/LDAP/squid_ldap_auth.c:1.21.2.17
*** squid/helpers/basic_auth/LDAP/squid_ldap_auth.c:1.21.2.15	Sun Jan 16 21:24:14 2005
--- squid/helpers/basic_auth/LDAP/squid_ldap_auth.c	Thu Feb  3 16:08:06 2005
***************
*** 587,594 ****
  	char escaped_login[256];
  	LDAPMessage *res = NULL;
  	LDAPMessage *entry;
! 	char *searchattr[] =
! 	{NULL};
  	char *userdn;
  	int rc;
  	LDAP *search_ld = persistent_ld;
--- 587,593 ----
  	char escaped_login[256];
  	LDAPMessage *res = NULL;
  	LDAPMessage *entry;
! 	char *searchattr[] = {LDAP_NO_ATTRS, NULL};
  	char *userdn;
  	int rc;
  	LDAP *search_ld = persistent_ld;
Index: squid/helpers/external_acl/ldap_group/squid_ldap_group.c
diff -c squid/helpers/external_acl/ldap_group/squid_ldap_group.c:1.2.2.17 squid/helpers/external_acl/ldap_group/squid_ldap_group.c:1.2.2.20
*** squid/helpers/external_acl/ldap_group/squid_ldap_group.c:1.2.2.17	Tue Mar  2 02:13:29 2004
--- squid/helpers/external_acl/ldap_group/squid_ldap_group.c	Thu Feb  3 16:14:41 2005
***************
*** 631,636 ****
--- 631,637 ----
      LDAPMessage *res = NULL;
      LDAPMessage *entry;
      int rc;
+     char *searchattr[] = {LDAP_NO_ATTRS, NULL};
  
      if (extension_dn && *extension_dn)
  	snprintf(searchbase, sizeof(searchbase), "%s,%s", extension_dn, basedn);
***************
*** 645,651 ****
      if (debug)
  	fprintf(stderr, "group filter '%s', searchbase '%s'\n", filter, searchbase);
  
!     rc = ldap_search_s(ld, searchbase, searchscope, filter, NULL, 1, &res);
      if (rc != LDAP_SUCCESS) {
  	if (noreferrals && rc == LDAP_PARTIAL_RESULTS) {
  	    /* Everything is fine. This is expected when referrals
--- 646,652 ----
      if (debug)
  	fprintf(stderr, "group filter '%s', searchbase '%s'\n", filter, searchbase);
  
!     rc = ldap_search_s(ld, searchbase, searchscope, filter, searchattr, 1, &res);
      if (rc != LDAP_SUCCESS) {
  	if (noreferrals && rc == LDAP_PARTIAL_RESULTS) {
  	    /* Everything is fine. This is expected when referrals
***************
*** 684,689 ****
--- 685,691 ----
  	LDAPMessage *entry;
  	int rc;
  	char *userdn;
+ 	char *searchattr[] = {LDAP_NO_ATTRS, NULL};
  	if (extension_dn && *extension_dn)
  	    snprintf(searchbase, sizeof(searchbase), "%s,%s", extension_dn, userbasedn ? userbasedn : basedn);
  	else
***************
*** 692,698 ****
  	snprintf(filter, sizeof(filter), usersearchfilter, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login);
  	if (debug)
  	    fprintf(stderr, "user filter '%s', searchbase '%s'\n", filter, searchbase);
! 	rc = ldap_search_s(ld, searchbase, searchscope, filter, NULL, 1, &res);
  	if (rc != LDAP_SUCCESS) {
  	    if (noreferrals && rc == LDAP_PARTIAL_RESULTS) {
  		/* Everything is fine. This is expected when referrals
--- 694,700 ----
  	snprintf(filter, sizeof(filter), usersearchfilter, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login, escaped_login);
  	if (debug)
  	    fprintf(stderr, "user filter '%s', searchbase '%s'\n", filter, searchbase);
! 	rc = ldap_search_s(ld, searchbase, searchscope, filter, searchattr, 1, &res);
  	if (rc != LDAP_SUCCESS) {
  	    if (noreferrals && rc == LDAP_PARTIAL_RESULTS) {
  		/* Everything is fine. This is expected when referrals
