diff -Nur squid-2.5.STABLE4.orig/helpers/basic_auth/SASL/Makefile.am squid-2.5.STABLE4/helpers/basic_auth/SASL/Makefile.am
--- squid-2.5.STABLE4.orig/helpers/basic_auth/SASL/Makefile.am	2003-12-17 20:20:18 +0500
+++ squid-2.5.STABLE4/helpers/basic_auth/SASL/Makefile.am	2003-12-18 10:07:18 +0500
@@ -9,5 +9,5 @@
 INCLUDES	= -I$(top_srcdir)/include
 
 libexec_PROGRAMS	= sasl_auth
-LDADD			= -L$(top_builddir)/lib -lmiscutil -lsasl $(XTRA_LIBS)
+LDADD			= -L$(top_builddir)/lib -lmiscutil -lsasl2 $(XTRA_LIBS)
 EXTRA_DIST		= squid_sasl_auth squid_sasl_auth.conf
diff -Nur squid-2.5.STABLE4.orig/helpers/basic_auth/SASL/Makefile.in squid-2.5.STABLE4/helpers/basic_auth/SASL/Makefile.in
--- squid-2.5.STABLE4.orig/helpers/basic_auth/SASL/Makefile.in	2003-12-17 20:20:18 +0500
+++ squid-2.5.STABLE4/helpers/basic_auth/SASL/Makefile.in	2003-12-18 10:07:18 +0500
@@ -120,10 +120,10 @@
 install_sh = @install_sh@
 makesnmplib = @makesnmplib@
 
-INCLUDES = -I$(top_srcdir)/include
+INCLUDES = -I$(top_srcdir)/include -I$(includedir)/sasl
 
 libexec_PROGRAMS = sasl_auth
-LDADD = -L$(top_builddir)/lib -lmiscutil -lsasl $(XTRA_LIBS)
+LDADD = -L$(top_builddir)/lib -lmiscutil -lsasl2 $(XTRA_LIBS)
 EXTRA_DIST = squid_sasl_auth squid_sasl_auth.conf
 subdir = helpers/basic_auth/SASL
 mkinstalldirs = $(SHELL) $(top_srcdir)/cfgaux/mkinstalldirs
diff -Nur squid-2.5.STABLE4.orig/helpers/basic_auth/SASL/sasl_auth.c squid-2.5.STABLE4/helpers/basic_auth/SASL/sasl_auth.c
--- squid-2.5.STABLE4.orig/helpers/basic_auth/SASL/sasl_auth.c	2003-12-17 20:20:18 +0500
+++ squid-2.5.STABLE4/helpers/basic_auth/SASL/sasl_auth.c	2003-12-18 10:09:38 +0500
@@ -40,7 +40,6 @@
 {
 	char line[8192];
 	char *username, *password;
-	const char *errstr;
 
 	int rc;
         sasl_conn_t *conn = NULL;
@@ -56,7 +55,7 @@
 		return 1;
 	}
 
-	rc = sasl_server_new( APP_NAME_SASL, NULL, NULL, NULL, 0, &conn );
+	rc = sasl_server_new( APP_NAME_SASL, NULL, NULL, NULL, NULL, NULL, 0, &conn );
 
 	if ( rc != SASL_OK ) {
 		fprintf( stderr, "error %d %s\n", rc, sasl_errstring(rc, NULL, NULL ));
@@ -84,12 +83,9 @@
 		rfc1738_unescape(username);
 		rfc1738_unescape(password);
 
-		rc = sasl_checkpass(conn, username, strlen(username), password, strlen(password), &errstr);
+		rc = sasl_checkpass(conn, username, strlen(username), password, strlen(password));
 
 		if ( rc != SASL_OK ) {
-			if ( errstr ) {
-				fprintf( stderr, "errstr %s\n", errstr );
-			}
 			if ( rc != SASL_BADAUTH ) {
 				fprintf( stderr, "error %d %s\n", rc, sasl_errstring(rc, NULL, NULL ));
 			}
